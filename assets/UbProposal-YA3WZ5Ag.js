import{m as f}from"./mixinFullScreenLoading-9dNja2ki.js";import{m as g}from"./mixinSwalToast--x5wgD_K.js";import{_ as d,o as s,c as o,a as t,S as C,q as u,t as c,b,F as h,d as m,e as y,u as D,D as w,r as x,j as I}from"./index-krZDK7h8.js";const k={},S={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",fill:"none",viewBox:"0 0 32 32"},P=t("path",{fill:"currentColor","fill-rule":"evenodd",d:"M24.94 7.057c.52.52.52 1.364 0 1.885l-16 16a1.333 1.333 0 1 1-1.885-1.886l16-16c.52-.52 1.364-.52 1.885 0Z","clip-rule":"evenodd"},null,-1),T=t("path",{fill:"currentColor","fill-rule":"evenodd",d:"M7.055 7.057a1.332 1.332 0 0 1 1.885 0l16 16a1.333 1.333 0 0 1-1.885 1.885l-16-16a1.333 1.333 0 0 1 0-1.885Z","clip-rule":"evenodd"},null,-1),M=[P,T];function U(e,r){return s(),o("svg",S,M)}const $=d(k,[["render",U]]),E={},R={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},L=t("path",{fill:"currentColor","fill-rule":"evenodd",d:"M18.707 5.293a1 1 0 0 1 0 1.414l-6 6a1 1 0 0 1-1.414 0l-6-6a1 1 0 0 1 1.414-1.414L12 10.586l5.293-5.293a1 1 0 0 1 1.414 0Zm0 7a1 1 0 0 1 0 1.414l-6 6a1 1 0 0 1-1.414 0l-6-6a1 1 0 1 1 1.414-1.414L12 17.586l5.293-5.293a1 1 0 0 1 1.414 0Z","clip-rule":"evenodd"},null,-1),j=[L];function B(e,r){return s(),o("svg",R,j)}const V=d(E,[["render",B]]);var O={VITE_URL:"https://api-dreamboost.vercel.app",VITE_WEIKEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRlc3RlbWFpbEBnbWFpbC5jb20iLCJ1c2VySUQiOiIzYTU4MjBhZi1iN2JlLTRkODMtOWM2My1kNmY1MWI2YmExMDEiLCJpYXQiOjE3MDg5Mzk5MDcsImV4cCI6MTcxMTUzMTkwN30.BbIXGVkQOU2HqsiCg6UcwFZx-kBd7kdOP24kUD21c1M",BASE_URL:"/DreamBoost/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:F}=O,J={props:["proposalData"],data(){return{collapseInstance:"",isShown:"",defineClass:[]}},methods:{initCollapse(){this.collapseInstance=new this.$bs.Collapse(this.$refs.collapseContent,{toggle:!1}),this.$refs.collapseContent.addEventListener("show.bs.collapse",()=>{this.isShown=!0}),this.$refs.collapseContent.addEventListener("hide.bs.collapse",()=>{this.isShown=!1})},toggle(){this.collapseInstance.toggle()},hide(){this.collapseInstance.hide()},setStatusCss(){this.proposalData.proposalStatus==="active"&&!this.isActive?this.defineClass=["bg-gray-600","text-dark-pr"]:this.defineClass=["bg-primary","text-white"]},submitDoubleCheck(){C.fire({title:"確定要送出提案嗎？",icon:"question",allowOutsideClick:!1,showCancelButton:!0,buttonsStyling:!0,confirmButtonText:"確認",cancelButtonText:"取消"}).then(e=>{e.isConfirmed&&this.submitToReview(),e.isDismissed}).catch(()=>{this.addToast({content:"提案送交審核過程出現錯誤",style:"error"})})},submitToReview(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)db\s*=\s*([^;]*).*$)|^.*$/,"$1");this.showFullScreenLoading({canCancel:!1}),this.$http.post(`${F}/dreamboost/proposal/admin/changeToReview`,{proposalID:this.proposalData.proposalID},{headers:{Authorization:e}}).then(()=>{this.hideFullScreenLoading(),this.addToast({content:"提案已送交審核"}),this.$emit("updateProposalRecordData")}).catch(()=>{this.hideFullScreenLoading(),this.addToast({content:"送交提案過程出現錯誤",style:"error"})})}},components:{DoubleAngleDownIcon:V,CloseButtonIcon:$},computed:{isActive(){return Date.parse(this.proposalData.proposalEndTime)>new Date().getTime()}},mounted(){this.initCollapse(),this.setStatusCss()},mixins:[g,f]},N={class:"l-cardContainer"},z={class:"l-gridCard"},Y={key:0},A={key:1},W={key:2},Z={key:3},Q=t("div",{class:"l-gridCard__titleName border-top border-bottom border-primary bg-bgc-paper d-flex justify-content-center align-items-center"},[t("span",null,"專案名稱")],-1),X={class:"l-gridCard__contentName border-bottom border-primary"},G={class:"h-100 px-1 py-1 d-flex align-items-center justify-content-center flex-wrap flex-xl-nowrap justify-content-xl-start"},q=["src"],H={class:"w-100 w-xl-auto mb-0 ms-3 text-center text-xl-start"},K=t("div",{class:"l-gridCard__titleTarget border-top border-bottom border-primary bg-bgc-paper d-flex justify-content-center align-items-center"},[t("span",null,"目標金額")],-1),tt={class:"l-gridCard--centerChild l-gridCard__contentTarget border-bottom border-primary d-flex justify-content-center align-items-center"},et=t("div",{class:"l-gridCard__titleCreatedDate border-top border-bottom border-primary bg-bgc-paper d-none d-sm-flex align-items-sm-center justify-content-sm-center"},[t("span",null,"創建日期")],-1),st={class:"l-gridCard__contentCreatedDate border-bottom border-primary d-none d-sm-flex align-items-sm-center justify-content-sm-center"},ot=t("div",{class:"l-gridCard__titleSubmitDate border-top border-bottom border-primary bg-bgc-paper d-none d-md-flex align-items-md-center justify-content-md-center"},[t("span",null,"提交日期")],-1),rt={class:"l-gridCard__contentSubmitDate border-bottom border-primary d-none d-md-flex align-items-md-center justify-content-md-center"},at=t("div",{class:"l-gridCard__titleUpdateDate border-top border-bottom border-primary bg-bgc-paper d-none d-lg-flex justify-content-lg-center align-items-lg-center"},[t("span",null,"上次修改日期")],-1),lt={class:"l-gridCard__contentUpdateDate border-bottom border-primary d-none d-lg-flex justify-content-lg-center align-items-lg-center"},it={class:"l-gridCard__btnDeleteProposal"},nt={type:"button",class:"btn btn-light rounded-0 p-0 h-100 w-100 l-btn-close border border-primary border-bottom-"},ct={class:"l-gridCard__btnViewDetail"},dt={ref:"collapseContent",class:"collapse"},pt={class:"row justify-content-end pt-3 g-1 g-sm-3"},_t=t("div",{class:"col-3"},[t("button",{class:"w-100 btn btn-outline-primary px-0 l-btn-edit"},"編輯")],-1),ht={class:"col-3"},mt=t("span",null,[y("送出"),t("span",{class:"d-none d-sm-inline"},"提案")],-1),ut=[mt],bt={key:1,class:"col-3"},ft=t("button",{class:"w-100 btn btn-primary px-0"},"查看詳情",-1),gt=[ft];function vt(e,r,a,v,l,i){const p=m("CloseButtonIcon"),n=m("DoubleAngleDownIcon");return s(),o("div",N,[t("div",z,[t("div",{class:u(["l-gridCard--centerChild l-gridCard__status px-5 d-flex align-items-center justify-content-center border border-primary",l.defineClass])},[a.proposalData.proposalStatus==="draft"?(s(),o("span",Y,"創建中專案")):a.proposalData.proposalStatus==="review"?(s(),o("span",A,"審核中專案")):a.proposalData.proposalStatus==="active"&&i.isActive?(s(),o("span",W,"進行中專案")):(s(),o("span",Z,"已結束專案"))],2),Q,t("div",X,[t("div",G,[t("img",{src:a.proposalData.proposalMainImage,alt:"提案主圖",width:"120",height:"90",class:""},null,8,q),t("p",H,c(a.proposalData.proposalTitle),1)])]),K,t("div",tt,[t("span",null,c(a.proposalData.proposalTargetMoney),1)]),et,t("div",st,[t("span",null,c(a.proposalData.proposalStartTime.split("-").join(".")),1)]),ot,t("div",rt,[t("span",null,c(a.proposalData.proposalStartTime.split("-").join(".")),1)]),at,t("div",lt,[t("span",null,c(a.proposalData.proposalStartTime.split("-").join(".")),1)]),t("div",it,[t("button",nt,[b(p)])]),t("div",ct,[t("button",{type:"button",class:u(["btn p-0 rounded-0 bg-primary-light w-100 h-100 l-btn-detail border border-primary border-top-0",{active:l.isShown}]),onClick:r[0]||(r[0]=(..._)=>i.toggle&&i.toggle(..._))},[b(n,{width:"24",height:"24"})],2)])]),t("div",dt,[t("div",pt,[a.proposalData.proposalStatus==="draft"?(s(),o(h,{key:0},[_t,t("div",ht,[t("button",{class:"w-100 btn btn-primary px-0",onClick:r[1]||(r[1]=(..._)=>i.submitDoubleCheck&&i.submitDoubleCheck(..._))},ut)])],64)):(s(),o("div",bt,gt))])],512)])}const Ct=d(J,[["render",vt]]);var yt={VITE_URL:"https://api-dreamboost.vercel.app",VITE_WEIKEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRlc3RlbWFpbEBnbWFpbC5jb20iLCJ1c2VySUQiOiIzYTU4MjBhZi1iN2JlLTRkODMtOWM2My1kNmY1MWI2YmExMDEiLCJpYXQiOjE3MDg5Mzk5MDcsImV4cCI6MTcxMTUzMTkwN30.BbIXGVkQOU2HqsiCg6UcwFZx-kBd7kdOP24kUD21c1M",BASE_URL:"/DreamBoost/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:Dt}=yt,wt={data(){return{userProposals:"",filterselect:"all",filteredProposals:[]}},methods:{getUserProposals(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)db\s*=\s*([^;]*).*$)|^.*$/,"$1");this.showFullScreenLoading({canCancel:!1}),this.$http.get(`${Dt}/dreamboost/proposal/normal/proposals`,{headers:{Authorization:e}}).then(r=>{this.hideFullScreenLoading(),this.userProposals=Object.values(r.data.data.result),this.filteredProposals=[...this.userProposals]}).catch(()=>{this.hideFullScreenLoading(),this.addToast({content:"取得提案失敗，請重新整理再次嘗試。",style:"error"})})}},computed:{draftProposals(){return this.userProposals.filter(e=>e.proposalStatus==="draft")},reviewProposals(){return this.userProposals.filter(e=>e.proposalStatus==="review")},activeProposals(){return this.userProposals.filter(e=>e.proposalStatus==="active")}},watch:{filterselect(e){e==="all"?this.filteredProposals=this.userProposals:e==="draft"?this.filteredProposals=this.draftProposals:e==="review"?this.filteredProposals=this.reviewProposals:e==="active"&&(this.filteredProposals=this.activeProposals)}},components:{ProposalRecordCard:Ct},mounted(){this.getUserProposals()},mixins:[f,g]},xt={class:"mt-17 container"},It=t("div",{class:"text-center"},[t("h3",{class:"text-primary mb-1 text-center"},"提案紀錄"),t("p",{class:"text-primary-light"},"Proposal Record")],-1),kt={class:"row g-0 mt-9"},St={class:"col-5 col-md-3"},Pt=t("p",{class:"text-gray-600 mb-1"},"專案狀態",-1),Tt=t("option",{value:"all"},"全部專案",-1),Mt=t("option",{value:"draft"},"草稿",-1),Ut=t("option",{value:"review"},"審核中",-1),$t=t("option",{value:"active"},"已上架",-1),Et=[Tt,Mt,Ut,$t],Rt={class:"row mt-13 mb-20"},Lt={class:"col-12"},jt={class:"l-proposalCardGapY"},Bt={key:0},Vt={key:1};function Ot(e,r,a,v,l,i){const p=m("ProposalRecordCard");return s(),o("section",xt,[It,l.userProposals?(s(),o(h,{key:0},[t("div",kt,[t("div",St,[Pt,D(t("select",{class:"form-select border border-primary-light text-gray-500","aria-label":"Default select","onUpdate:modelValue":r[0]||(r[0]=n=>l.filterselect=n)},Et,512),[[w,l.filterselect]])])]),t("div",Rt,[t("div",Lt,[t("div",jt,[l.filteredProposals.length===0?(s(),o("p",Bt,"目前篩選的條件沒有提案")):(s(!0),o(h,{key:1},x(l.filteredProposals,n=>(s(),I(p,{key:n.proposalID,"proposal-data":n,onUpdateProposalRecordData:i.getUserProposals},null,8,["proposal-data","onUpdateProposalRecordData"]))),128))])])])],64)):(s(),o("p",Vt,"目前沒有任何提案"))])}const zt=d(wt,[["render",Ot]]);export{zt as default};
