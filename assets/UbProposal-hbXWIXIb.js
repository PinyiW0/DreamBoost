import{m as f}from"./mixinFullScreenLoading-9dNja2ki.js";import{m as g}from"./mixinSwalToast-bZvn4e3b.js";import{_ as c,o as s,c as o,a as t,S as y,q as m,t as d,b,F as h,d as u,e as C,u as w,D,r as x,j as S}from"./index-oVBGm4bI.js";const P={},$={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",fill:"none",viewBox:"0 0 32 32"},k=t("path",{fill:"currentColor","fill-rule":"evenodd",d:"M24.94 7.057c.52.52.52 1.364 0 1.885l-16 16a1.333 1.333 0 1 1-1.885-1.886l16-16c.52-.52 1.364-.52 1.885 0Z","clip-rule":"evenodd"},null,-1),T=t("path",{fill:"currentColor","fill-rule":"evenodd",d:"M7.055 7.057a1.332 1.332 0 0 1 1.885 0l16 16a1.333 1.333 0 0 1-1.885 1.885l-16-16a1.333 1.333 0 0 1 0-1.885Z","clip-rule":"evenodd"},null,-1),R=[k,T];function I(e,r){return s(),o("svg",$,R)}const L=c(P,[["render",I]]),j={},B={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},U=t("path",{fill:"currentColor","fill-rule":"evenodd",d:"M18.707 5.293a1 1 0 0 1 0 1.414l-6 6a1 1 0 0 1-1.414 0l-6-6a1 1 0 0 1 1.414-1.414L12 10.586l5.293-5.293a1 1 0 0 1 1.414 0Zm0 7a1 1 0 0 1 0 1.414l-6 6a1 1 0 0 1-1.414 0l-6-6a1 1 0 1 1 1.414-1.414L12 17.586l5.293-5.293a1 1 0 0 1 1.414 0Z","clip-rule":"evenodd"},null,-1),E=[U];function V(e,r){return s(),o("svg",B,E)}const A=c(j,[["render",V]]);var F={VITE_URL:"https://api.dreamboost.shop",BASE_URL:"/DreamBoost/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:M}=F,O={props:["proposalData"],data(){return{collapseInstance:"",isShown:"",defineClass:[]}},methods:{initCollapse(){this.collapseInstance=new this.$bs.Collapse(this.$refs.collapseContent,{toggle:!1}),this.$refs.collapseContent.addEventListener("show.bs.collapse",()=>{this.isShown=!0}),this.$refs.collapseContent.addEventListener("hide.bs.collapse",()=>{this.isShown=!1})},toggle(){this.collapseInstance.toggle()},hide(){this.collapseInstance.hide()},setStatusCss(){this.proposalData.proposalStatus==="active"&&!this.isActive?this.defineClass=["bg-gray-600","text-dark-pr"]:this.defineClass=["bg-primary","text-white"]},submitDoubleCheck(){y.fire({title:"確定要送出提案嗎？",icon:"question",allowOutsideClick:!1,showCancelButton:!0,buttonsStyling:!0,confirmButtonText:"確認",cancelButtonText:"取消"}).then(e=>{e.isConfirmed&&this.submitToReview(),e.isDismissed}).catch(()=>{this.addToast({content:"提案送交審核過程出現錯誤",style:"error"})})},submitToReview(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)db\s*=\s*([^;]*).*$)|^.*$/,"$1");this.showFullScreenLoading({canCancel:!1}),this.$http.post(`${M}/dreamboost/proposal/admin/changeToReview`,{proposalID:this.proposalData.proposalID},{headers:{Authorization:e}}).then(()=>{this.hideFullScreenLoading(),this.addToast({content:"提案已送交審核"}),this.$emit("updateProposalRecordData")}).catch(()=>{this.hideFullScreenLoading(),this.addToast({content:"送交提案過程出現錯誤",style:"error"})})}},components:{DoubleAngleDownIcon:A,CloseButtonIcon:L},computed:{isActive(){return Date.parse(this.proposalData.proposalEndTime)>new Date().getTime()}},mounted(){this.initCollapse(),this.setStatusCss()},mixins:[g,f]},N={class:"l-cardContainer"},Z={class:"l-gridCard"},z={key:0},q={key:1},G={key:2},Y={key:3},H=t("div",{class:"l-gridCard__titleName border-top border-bottom border-primary bg-bgc-paper d-flex justify-content-center align-items-center"},[t("span",null,"專案名稱")],-1),J={class:"l-gridCard__contentName border-bottom border-primary"},K={class:"h-100 px-1 py-1 d-flex align-items-center justify-content-center flex-wrap flex-xl-nowrap justify-content-xl-start"},Q=["src"],W={class:"w-100 w-xl-auto mb-0 ms-3 text-center text-xl-start"},X=t("div",{class:"l-gridCard__titleTarget border-top border-bottom border-primary bg-bgc-paper d-flex justify-content-center align-items-center"},[t("span",null,"目標金額")],-1),tt={class:"l-gridCard--centerChild l-gridCard__contentTarget border-bottom border-primary d-flex justify-content-center align-items-center"},et=t("div",{class:"l-gridCard__titleCreatedDate border-top border-bottom border-primary bg-bgc-paper d-none d-sm-flex align-items-sm-center justify-content-sm-center"},[t("span",null,"創建日期")],-1),st={class:"l-gridCard__contentCreatedDate border-bottom border-primary d-none d-sm-flex align-items-sm-center justify-content-sm-center"},ot=t("div",{class:"l-gridCard__titleSubmitDate border-top border-bottom border-primary bg-bgc-paper d-none d-md-flex align-items-md-center justify-content-md-center"},[t("span",null,"提交日期")],-1),rt={class:"l-gridCard__contentSubmitDate border-bottom border-primary d-none d-md-flex align-items-md-center justify-content-md-center"},at=t("div",{class:"l-gridCard__titleUpdateDate border-top border-bottom border-primary bg-bgc-paper d-none d-lg-flex justify-content-lg-center align-items-lg-center"},[t("span",null,"上次修改日期")],-1),lt={class:"l-gridCard__contentUpdateDate border-bottom border-primary d-none d-lg-flex justify-content-lg-center align-items-lg-center"},nt={class:"l-gridCard__btnDeleteProposal"},it={type:"button",class:"btn btn-light rounded-0 p-0 h-100 w-100 l-btn-close border border-primary border-bottom-"},dt={class:"l-gridCard__btnViewDetail"},ct={ref:"collapseContent",class:"collapse"},pt={class:"row justify-content-end pt-3 g-1 g-sm-3"},_t=t("div",{class:"col-3"},[t("button",{class:"w-100 btn btn-outline-primary px-0 l-btn-edit"},"編輯")],-1),ht={class:"col-3"},ut=t("span",null,[C("送出"),t("span",{class:"d-none d-sm-inline"},"提案")],-1),mt=[ut],bt={key:1,class:"col-3"},ft=t("button",{class:"w-100 btn btn-primary px-0"},"查看詳情",-1),gt=[ft];function vt(e,r,a,v,l,n){const p=u("CloseButtonIcon"),i=u("DoubleAngleDownIcon");return s(),o("div",N,[t("div",Z,[t("div",{class:m(["l-gridCard--centerChild l-gridCard__status px-5 d-flex align-items-center justify-content-center border border-primary",l.defineClass])},[a.proposalData.proposalStatus==="draft"?(s(),o("span",z,"創建中專案")):a.proposalData.proposalStatus==="review"?(s(),o("span",q,"審核中專案")):a.proposalData.proposalStatus==="active"&&n.isActive?(s(),o("span",G,"進行中專案")):(s(),o("span",Y,"已結束專案"))],2),H,t("div",J,[t("div",K,[t("img",{src:a.proposalData.proposalMainImage,alt:"提案主圖",width:"120",height:"90",class:""},null,8,Q),t("p",W,d(a.proposalData.proposalTitle),1)])]),X,t("div",tt,[t("span",null,d(a.proposalData.proposalTargetMoney),1)]),et,t("div",st,[t("span",null,d(a.proposalData.proposalStartTime.split("-").join(".")),1)]),ot,t("div",rt,[t("span",null,d(a.proposalData.proposalStartTime.split("-").join(".")),1)]),at,t("div",lt,[t("span",null,d(a.proposalData.proposalStartTime.split("-").join(".")),1)]),t("div",nt,[t("button",it,[b(p)])]),t("div",dt,[t("button",{type:"button",class:m(["btn p-0 rounded-0 bg-primary-light w-100 h-100 l-btn-detail border border-primary border-top-0",{active:l.isShown}]),onClick:r[0]||(r[0]=(..._)=>n.toggle&&n.toggle(..._))},[b(i,{width:"24",height:"24"})],2)])]),t("div",ct,[t("div",pt,[a.proposalData.proposalStatus==="draft"?(s(),o(h,{key:0},[_t,t("div",ht,[t("button",{class:"w-100 btn btn-primary px-0",onClick:r[1]||(r[1]=(..._)=>n.submitDoubleCheck&&n.submitDoubleCheck(..._))},mt)])],64)):(s(),o("div",bt,gt))])],512)])}const yt=c(O,[["render",vt]]);var Ct={VITE_URL:"https://api.dreamboost.shop",BASE_URL:"/DreamBoost/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:wt}=Ct,Dt={data(){return{userProposals:"",filterselect:"all",filteredProposals:[]}},methods:{getUserProposals(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)db\s*=\s*([^;]*).*$)|^.*$/,"$1");this.showFullScreenLoading({canCancel:!1}),this.$http.get(`${wt}/dreamboost/proposal/normal/proposals`,{headers:{Authorization:e}}).then(r=>{this.hideFullScreenLoading(),this.userProposals=Object.values(r.data.data.result),this.filteredProposals=[...this.userProposals]}).catch(()=>{this.hideFullScreenLoading(),this.addToast({content:"取得提案失敗，請重新整理再次嘗試。",style:"error"})})}},computed:{draftProposals(){return this.userProposals.filter(e=>e.proposalStatus==="draft")},reviewProposals(){return this.userProposals.filter(e=>e.proposalStatus==="review")},activeProposals(){return this.userProposals.filter(e=>e.proposalStatus==="active")}},watch:{filterselect(e){e==="all"?this.filteredProposals=this.userProposals:e==="draft"?this.filteredProposals=this.draftProposals:e==="review"?this.filteredProposals=this.reviewProposals:e==="active"&&(this.filteredProposals=this.activeProposals)}},components:{ProposalRecordCard:yt},mounted(){this.getUserProposals()},mixins:[f,g]},xt={class:"mt-17 container"},St=t("div",{class:"text-center"},[t("h3",{class:"text-primary mb-1 text-center"},"提案紀錄"),t("p",{class:"text-primary-light"},"Proposal Record")],-1),Pt={class:"row g-0 mt-9"},$t={class:"col-5 col-md-3"},kt=t("p",{class:"text-gray-600 mb-1"},"專案狀態",-1),Tt=t("option",{value:"all"},"全部專案",-1),Rt=t("option",{value:"draft"},"草稿",-1),It=t("option",{value:"review"},"審核中",-1),Lt=t("option",{value:"active"},"已上架",-1),jt=[Tt,Rt,It,Lt],Bt={class:"row mt-13 mb-20"},Ut={class:"col-12"},Et={class:"l-proposalCardGapY"},Vt={key:0},At={key:1};function Ft(e,r,a,v,l,n){const p=u("ProposalRecordCard");return s(),o("section",xt,[St,l.userProposals?(s(),o(h,{key:0},[t("div",Pt,[t("div",$t,[kt,w(t("select",{class:"form-select border border-primary-light text-gray-500","aria-label":"Default select","onUpdate:modelValue":r[0]||(r[0]=i=>l.filterselect=i)},jt,512),[[D,l.filterselect]])])]),t("div",Bt,[t("div",Ut,[t("div",Et,[l.filteredProposals.length===0?(s(),o("p",Vt,"目前篩選的條件沒有提案")):(s(!0),o(h,{key:1},x(l.filteredProposals,i=>(s(),S(p,{key:i.proposalID,"proposal-data":i,onUpdateProposalRecordData:n.getUserProposals},null,8,["proposal-data","onUpdateProposalRecordData"]))),128))])])])],64)):(s(),o("p",At,"目前沒有任何提案"))])}const Zt=c(Dt,[["render",Ft]]);export{Zt as default};
